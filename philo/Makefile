NAME	=	philo
CC		=	cc
CFLAGS	=	-Wall -Wextra -Werror -O3 #-fsanitize=thread -g

SRCDIR	=	.
OBJDIR	=	objs

SRCS	=	$(shell find $(SRCDIR) -name '*.c')
OBJS	=	$(patsubst $(SRCDIR)/%.c, $(OBJDIR)/%.o, $(SRCS))

$(OBJDIR)/%.o: $(SRCDIR)/%.c
	@mkdir -p $(dir $@)
	@$(CC) $(CFLAGS) -c $< -o $@

$(NAME): $(OBJS)
	@echo "Inviting philosophers over ðŸ¤”ðŸ§ ðŸ’­"
	@$(CC) $(CFLAGS) $(OBJS) -o $(NAME) -lpthread
	@echo "Cooking up the dinner ðŸ²ðŸ³ðŸ–"
	@echo "Setting the table ðŸ½ï¸ ðŸ´"
	@echo "âœ… Ready to eat âœ…"

clean:
	@echo "Washing the dishes... ðŸ’¦ðŸ§¼ðŸ«§"
	@if [ -n "$(OBJDIR)" ] && [ "$(OBJDIR)" != "/" ]; then rm -rf $(OBJDIR); fi

fclean: clean
	@rm -f $(NAME)

re: fclean all
all: $(NAME)

.PHONY: all clean fclean re

